<!-- templates/admin/base_admin.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="{{ url_for('static', path='favicon.ico') }}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', path='favicon-32.png') }}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', path='favicon-16.png') }}">
  <title>{% block title %}GPT ê´€ë¦¬ì{% endblock %}</title>

  <!-- âœ… ì •ì  íŒŒì¼ì€ url_for('static', path=...) ì‚¬ìš© -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/admin/base.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', path='css/admin/users.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', path='css/admin/category_dropdown.css') }}" />

  {% block head %}{% endblock %}
</head>
<body>

<div class="admin-layout">
  <!-- ì™¼ìª½ ì‚¬ì´ë“œë°” -->
  <aside class="sidebar">
    <div class="logo">
      <span class="logo-text">GPT Admin</span>
    </div>

    <nav class="sidebar-menu">
      <a href="/admin/dashboard" class="{{ 'active' if active_page == 'dashboard' else '' }}">ëŒ€ì‹œë³´ë“œ</a>
      <a href="/admin/users" class="{{ 'active' if active_page == 'users' else '' }}">íšŒì›ê´€ë¦¬</a>

      <!-- â–¼ ì¹´í…Œê³ ë¦¬ê²Œì‹œë¬¼ (í˜„ì¬ ê²Œì‹œíŒì´ë©´ ìë™ìœ¼ë¡œ í¼ì¹¨) -->
      {% set is_posts_section = ('posts_' in (active_page or '')) %}
      <div class="menu-group">
        <button type="button"
                class="menu-toggle {{ 'active' if is_posts_section else '' }}"
                aria-expanded="{{ 'true' if is_posts_section else 'false' }}">
          ì¹´í…Œê³ ë¦¬ê²Œì‹œë¬¼ â–¾
        </button>

        <div class="submenu {{ 'open' if is_posts_section else '' }}">
          <a href="{{ request.url_for('admin_board_list', board='best')    }}" class="{{ 'active' if active_page=='posts_best' else '' }}">ë² ìŠ¤íŠ¸</a>
          <a href="{{ request.url_for('admin_board_list', board='game')    }}" class="{{ 'active' if active_page=='posts_game' else '' }}">ê²Œì„</a>
          <a href="{{ request.url_for('admin_board_list', board='sports')  }}" class="{{ 'active' if active_page=='posts_sports' else '' }}">ìŠ¤í¬ì¸ </a>
          <a href="{{ request.url_for('admin_board_list', board='invest')  }}" class="{{ 'active' if active_page=='posts_invest' else '' }}">íˆ¬ì</a>
          <a href="{{ request.url_for('admin_board_list', board='gallery') }}" class="{{ 'active' if active_page=='posts_gallery' else '' }}">ê°¤ëŸ¬ë¦¬</a>
          <a href="{{ request.url_for('admin_board_list', board='free')    }}" class="{{ 'active' if active_page=='posts_free' else '' }}">ì¼ë°˜</a>
          <a href="{{ request.url_for('admin_board_list', board='humor')   }}" class="{{ 'active' if active_page=='posts_humor' else '' }}">ìœ ë¨¸</a>
          <a href="{{ request.url_for('admin_board_list', board='report')  }}" class="{{ 'active' if active_page=='posts_report' else '' }}">ì‹ ë¬¸ê³ </a>
        </div>
      </div>

      <a href="/admin/events" class="{{ 'active' if active_page == 'events' else '' }}">ì´ë²¤íŠ¸</a>
      <a href="/admin/live"   class="{{ 'active' if active_page == 'live'   else '' }}">ë¼ì´ë¸Œ</a>

      <!-- âœ… ê´€ë¦¬ì ë¡œê·¸ì•„ì›ƒ: POST + next -->
      <form method="post" action="/admin/logout">
  <input type="hidden" name="next" value="/admin/login">
  <button type="submit">ë¡œê·¸ì•„ì›ƒ</button>
</form>
    </nav>
  </aside>

  <!-- ì˜¤ë¥¸ìª½ ë©”ì¸ ì»¨í…ì¸  -->
  <div class="main-content">
    <header class="topbar">
      <div class="topbar-left">
        <h2>{% block page_title %}ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ{% endblock %}</h2>
      </div>
      <div class="topbar-right">
        <span class="topbar-icon">ğŸ””</span>
        <span class="topbar-avatar">ğŸ‘¤</span>
      </div>
    </header>

    <div class="dashboard-content">
      {% block content %}{% endblock %}
    </div>
  </div>
</div>

<!-- ë“œë¡­ë‹¤ìš´ í† ê¸€ -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const toggles = document.querySelectorAll(".menu-toggle");
  toggles.forEach(btn => {
    btn.addEventListener("click", (e) => {
      e.preventDefault();
      const submenu = btn.nextElementSibling;
      const willOpen = !submenu.classList.contains("open");

      // ë‹¤ë¥¸ ì—´ë¦° ì„œë¸Œë©”ë‰´ ë‹«ê¸°(í•„ìš”ì‹œ ìœ ì§€)
      document.querySelectorAll(".submenu.open").forEach(el => {
        if (el !== submenu) el.classList.remove("open");
      });

      submenu.classList.toggle("open", willOpen);
      btn.setAttribute("aria-expanded", String(willOpen));
    });
  });
});
</script>
</body>
</html>
