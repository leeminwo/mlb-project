<!DOCTYPE html>
<html lang="ko">
<head>
<link rel="icon" href="{{ url_for('static', path='favicon.ico') }}">
<link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', path='favicon-32.png') }}">
<link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', path='favicon-16.png') }}">
  <meta charset="UTF-8">
  <title>GPT ì»¤ë®¤ë‹ˆí‹°</title>
  <link rel="stylesheet" href="/static/css/home.css">
  <link rel="stylesheet" href="/static/css/tabs.css">
  {% block head %}{% endblock %}
</head>
<body>
  <!-- ìƒë‹¨ í—¤ë”ë°” -->
  <div class="top-bar">
    <div class="top-left">
      GPT ì»¤ë®¤ë‹ˆí‹° - ìœ ë¨¸, ê²Œì„, íˆ¬ì, ìŠ¤í¬ì¸  ì¢…í•© ì»¤ë®¤ë‹ˆí‹°
    </div>

    <div class="top-right">
      {% set user = request.session.get('user') %}
      {% set admin_logged_in = request.session.get('admin_logged_in') %}
      {% set on_admin = request.url.path.startswith('/admin') %}

      {% if not user %}
        <!-- ë¹„ë¡œê·¸ì¸(ìœ ì €) -->
        <div class="auth-links">
          <a href="/login?next={{ request.url.path }}{% if request.url.query %}%3F{{ request.url.query|urlencode }}{% endif %}">ë¡œê·¸ì¸</a>
          <span class="divider">|</span>
          <a href="/register?next={{ request.url.path }}{% if request.url.query %}%3F{{ request.url.query|urlencode }}{% endif %}">íšŒì›ê°€ì…</a>
        </div>
      {% else %}
        <!-- ìœ ì € ë¡œê·¸ì¸ -->
        <div class="auth-user">
          <span class="hello">ì•ˆë…•í•˜ì„¸ìš”, <strong>{{ user.nickname }}</strong>ë‹˜</span>
          <span class="user-points">ğŸ’° {{ user.points or 0 }}</span>
          {% if user.is_admin %}
            <a class="link" href="/admin/dashboard">ê´€ë¦¬ì</a>
          {% endif %}
          <form class="logout-form" method="post" action="/logout">
            <!-- í˜„ì¬ í˜ì´ì§€ë¡œ ë³µê·€ -->
            <input type="hidden" name="next" value="{{ request.url.path }}{% if request.url.query %}?{{ request.url.query|urlencode }}{% endif %}">
            <button type="submit" class="btn-logout">ë¡œê·¸ì•„ì›ƒ</button>
          </form>
        </div>
      {% endif %}

      {# ê´€ë¦¬ì ì˜ì—­ì— ìˆì„ ë•Œë§Œ, ê´€ë¦¬ì í”Œë˜ê·¸ ì „ìš© UI ì¶”ê°€ #}
      {% if on_admin and admin_logged_in %}
        <div class="auth-user">
          <span class="hello"><strong>ê´€ë¦¬ì</strong> ëª¨ë“œ</span>
          <a class="link" href="/admin/dashboard">ëŒ€ì‹œë³´ë“œ</a>
          <form class="logout-form" method="post" action="/admin/logout">
            <input type="hidden" name="next" value="/admin/login">
            <button type="submit" class="btn-logout">ê´€ë¦¬ì ë¡œê·¸ì•„ì›ƒ</button>
          </form>
        </div>
      {% endif %}

      <!-- í†µí•©ê²€ìƒ‰ -->
      <form class="search-form" action="/search" method="get">
        <input type="text" name="q" placeholder="ê²Œì‹œíŒëª… & í†µí•©ê²€ìƒ‰" value="{{ request.query_params.get('q','') }}">
        <button type="submit">ê²€ìƒ‰</button>
      </form>
    </div>
  </div>

  <div class="wrapper">
    <!-- í—¤ë” ë°°ë„ˆ -->
    <header class="header-banner">
      <img src="/static/images/platforms_banner.png" alt="Platforms ë°°ë„ˆ">
    </header>

    <!-- íƒ­ ë©”ë‰´ -->
    {% set cat = category or '' %}
    <nav class="tabs-wrapper">
      <div class="tabs-left">
        <a href="/trendy"  class="{{ 'active' if cat.startswith('trendy')  else '' }}">ë² ìŠ¤íŠ¸</a>
        <a href="/game"    class="{{ 'active' if cat.startswith('game')    else '' }}">ê²Œì„</a>
        <a href="/sports"  class="{{ 'active' if cat.startswith('sports')  else '' }}">ìŠ¤í¬ì¸ </a>
        <a href="/invest"  class="{{ 'active' if cat.startswith('invest')  else '' }}">íˆ¬ì</a>
        <a href="/gallery" class="{{ 'active' if cat.startswith('gallery') else '' }}">ê°¤ëŸ¬ë¦¬</a>
        <a href="/free"    class="{{ 'active' if cat.startswith('free')    else '' }}">ì¼ë°˜</a>
        <a href="/humor"   class="{{ 'active' if cat.startswith('humor')   else '' }}">ìœ ë¨¸</a>
        <a href="/report"  class="{{ 'active' if cat.startswith('report')  else '' }}">ì‹ ë¬¸ê³ </a>
      </div>
      <div class="tabs-right">
        <a href="/counsel" class="{{ 'active' if cat.startswith('counsel') else '' }}">ìƒë‹´ìš”ì²­</a>
      </div>
    </nav>

    <!-- ì»¨í…ì¸  ë°•ìŠ¤: ì „ì²´ í­ ì‚¬ìš© -->
    <main class="content content--full">
      {% block content %}
        {# ë™ì  include: category ê°’ì— ë”°ë¼ ìë™ ë§¤í•‘ #}
        {% set boards = ['trendy','game','sports','invest','gallery','free','humor','report','counsel'] %}
        {% if not cat %}
          {% set partial = 'boards/home.html' %}
        {% elif cat in boards %}
          {# ì˜ˆ: category='invest' â†’ boards/invest_content.html #}
          {% set partial = 'boards/' ~ cat ~ '_content.html' %}
          {# ëª¨ë“  ê²Œì‹œíŒì— with context ì‚¬ìš©í•˜ì—¬ ë³€ìˆ˜ ì „ë‹¬ #}
          {% include partial with context %}
        {% else %}
          {# ì˜ˆ: category='invest_content' / 'invest_write' / 'trendy_content' ë“± #}
          {% set partial = 'boards/' ~ cat ~ '.html' %}
          {% include partial ignore missing %}
        {% endif %}
      {% endblock %}
    </main>
  </div>
</body>
</html>
